#!/usr/bin/env python

from sys import exit
from os import path
from numpy import loadtxt, array, sqrt, arange
from matplotlib import rc, pyplot

#rc('text', usetex=True)
#rc('text.latex', preamble='\usepackage{yfonts},\usepackage[T1]{fontenc},\usepackage[latin1]{inputenc},\usepackage{txfonts},\usepackage{lmodern},\usepackage{blindtext}')
#rc('font', family='serif')

xi1320_xfn = {
    'noprot' : {
        'erg' : (arange(1.5,5.5,0.125) + (0.5*0.125)),
        'flux' : [5.25225679679e+12, 4.32150561358e+12, 4.73231297337e+12, 4.14111579936e+12, 4.09623668566e+12, 4.03537518808e+12, 3.42927168542e+12, 3.21375734412e+12, 2.85526644607e+12, 2.78221902968e+12, 2.71909708537e+12, 2.73096749342e+12, 2.05142701681e+12, 1.94035557862e+12, 2.04480463973e+12, 2.17816379264e+12, 2.19022349697e+12, 2.03420816472e+12, 1.71964781134e+12, 2.12265007187e+12, 1.76945050854e+12, 1.91917204794e+12, 1.67938105174e+12, 1.49850085032e+12, 1.83304486558e+12, 1.71979723266e+12, 1.5533695894e+12, 1.6698138952e+12, 1.64409963958e+12, 1.67032378867e+12, 1.44050206684e+12, 1.06051403414e+12],
        'basic' : {
            'measyield' :[27.186399999999999, 117.152, 259.65300000000002, 8.5893899999999999, 451.964, 611.89800000000002, 717.173, 918.96000000000004, 1350.4400000000001, 1324.1199999999999, 1436.25, 1109.4400000000001, 1400.71, 1191.3199999999999, 935.39200000000005, 1259.79, 1113.5999999999999, 995.96799999999996, 1070.1900000000001, 958.72400000000005, 1036.01, 870.18399999999997, 557.01999999999998],
            'measyielderr' :[6.9010199999999999, 11.8802, 17.4588, 4.5173300000000003, 24.883700000000001, 29.630600000000001, 32.650300000000001, 38.974899999999998, 47.374600000000001, 49.250599999999999, 55.231999999999999, 51.505400000000002, 57.330599999999997, 57.019799999999996, 52.805399999999999, 65.6233, 61.260199999999998, 61.807200000000002, 67.531499999999994, 67.826899999999995, 70.597499999999997, 68.183300000000003, 55.093299999999999],
            'fluxcorrmeasyield' :[5.7751207080459395, 25.463944153388713, 56.192388725713073, 2.4746109582962501, 137.66489260799889, 176.85929605291241, 194.59607517618429, 247.97554563087627, 392.35625486494405, 455.08080154238627, 399.9008408059467, 370.56643575248108, 431.35516223414754, 419.25655777810721, 368.92436447705779, 406.18674033344263, 382.69488426588657, 378.94071184277908, 378.78563292866568, 344.64036809580927, 366.57594375734055, 357.02439199517056, 310.42382732397772],
            'fluxcorrmeasyielderr' :[1.4659617863619439, 2.5822585131837097, 3.7783182798743247, 1.301446822213248, 7.579391032208032, 8.5642493653711771, 8.8592574372273489, 10.517130337158772, 13.764195843900671, 16.926715500977178, 15.378467009860534, 17.203429209788919, 17.655225041462504, 20.066753749037243, 20.826774911477216, 21.158537787729031, 21.0524112350551, 23.516081206390758, 23.90226218899986, 24.382291237330023, 24.979821807779011, 27.974659644512617, 30.703157959736341],
            'accept' :[       0.42638575369952342, 1.3309444586639365, 1.9975098792832782, 2.827852483024897, 3.5780583388516778, 0.11297188355762018, 4.8591235769255237, 5.3054388554558871, 5.8428505582300518, 6.360650674965405, 6.5800556705286466, 6.8401177202772123, 6.9340466983791051, 7.141936254028888, 7.0788998561124705, 6.9793619350235536, 6.6182426140325799, 6.7023104029030183, 6.4740178271244533, 6.3963162325976706, 6.023363826081499, 5.7533181756349716, 5.4489856916226636, 5.2292500827889334, 4.9868504405582321],
            'accepterr' :[       0.059581013787357626, 0.061113008934702236, 0.05943436118419522, 0.060485780027145879, 0.061198969513922383, 0.010098848840850121, 0.060624974872271142, 0.059710502522649374, 0.059345636810824672, 0.059475389207943048, 0.058557590652625141, 0.057973022276423133, 0.056488856578257481, 0.056273583436013283, 0.054901954390452208, 0.05363889820196166, 0.051738396944953143, 0.051247379573827245, 0.049825292294347928, 0.048877670876002019, 0.047122137880919734, 0.04590684022713451, 0.044432402592573333, 0.043184956352354247, 0.042651192295921229],
            'xfn' :[0.28911600227569817, 0.90046932455792184, 1.5704715631815869, 2.1904662296208413, 2.8331218671146154, 3.3335469670155149, 3.3304989274812526, 3.8985877122111403, 5.9628105674282503, 6.6531135888688029, 5.7672072052734658, 5.188599037739074, 6.0935338965373553, 6.0070900704290846, 5.5743553990425179, 6.0603988164664546, 5.91124236115777, 5.924358616160597, 6.288606231762107, 5.9902886921037108, 6.727416156018152, 6.8274491818673448, 6.2248473465193506],
            'xfnerr' :[0.073891914666987302, 0.093324299668733485, 0.10895976997094907, 1.1685324090009295, 0.15993762004918075, 0.16572649300734979, 0.15535327951553871, 0.16931755630825998, 0.21580626947110904, 0.25380548888571164, 0.22670391145999955, 0.24432378537163824, 0.25384445004951195, 0.29119851309968564, 0.31769037533565292, 0.31907307654789291, 0.32835004494881359, 0.37042716655308328, 0.39986383376287388, 0.42648219466359605, 0.46170117829035973, 0.53792813917683036, 0.61797993030918597],



        },
        'tofe' : {
            'measyield' :[11.6334, 80.867699999999999, 145.03899999999999, 5.0, 313.49000000000001, 419.27600000000001, 516.14800000000002, 658.45100000000002, 916.56100000000004, 895.57299999999998, 982.79600000000005, 796.37599999999998, 882.92999999999995, 775.49900000000002, 710.52300000000002, 936.447, 759.197, 683.28099999999995, 648.65800000000002, 619.80700000000002, 579.202, 467.56128999999999, 417.12700000000001],
            'measyielderr' :[5.44618, 9.2956199999999995, 12.326000000000001, 3.0, 18.2315, 20.9346, 23.204799999999999, 26.903300000000002, 31.574999999999999, 32.009500000000003, 34.526299999999999, 32.316099999999999, 34.123199999999997, 33.857999999999997, 32.731000000000002, 38.359699999999997, 36.169699999999999, 35.788800000000002, 36.581600000000002, 38.9754, 38.472799999999999, 37.108800000000002, 32.911700000000003],
            'fluxcorrmeasyield' :[2.4712462571352454, 17.577255160927621, 31.388383220639462, 1.4405044818643993, 95.486736075620129, 121.18499849955532, 140.05041323367888, 177.67883911834696, 266.29723743022123, 307.79542539929878, 273.64382714758659, 265.99925713767112, 271.90240191859544, 272.91831019404054, 280.2346462459937, 301.93314316277429, 260.90230607938963, 259.97119237630721, 229.58757891985761, 222.80709842286129, 204.94157370695183, 191.83389407611219, 232.46231700866909],
            'fluxcorrmeasyielderr' :[1.1569147403764908, 2.0204789380840045, 2.6675115767994111, 0.86430268911922481, 5.5531800979147752, 6.0508101342257135, 6.2963371540216446, 7.2596854027198594, 9.173786876815317, 11.001199982091096, 9.6132960157031135, 10.793969927599299, 10.508398222698249, 11.915512654423949, 12.909307943190916, 12.368094290081387, 12.429920220191127, 13.616736029260005, 12.947779843623875, 14.010806242166128, 13.612998880265879, 15.225224502404593, 18.34148841785268],
            'accept' :[       0.25917565420951422, 0.84179393112078038, 1.3803930060087697, 1.9091998402343231, 2.5109371777196392, 0.076820880819181717, 3.428098963302169, 3.7569546951288744, 4.1988886612721501, 4.5284744534651002, 4.6505530794504351, 4.8311726669549904, 4.89334137682091, 5.0409454458636747, 4.9714516143814214, 4.8876362169899537, 4.6336360919450623, 4.6670054641595655, 4.4813815611444134, 4.4055974749913211, 4.1098523481508211, 3.9441108455275069, 3.7000988634534764, 3.5685793419032419, 3.403528305146565],
            'accepterr' :[       0.046490903739726294, 0.048722598350843589, 0.049562999859793948, 0.049933710999632876, 0.051549960364082381, 0.0083292309376144531, 0.051302802683367114, 0.050655920163397664, 0.050746045808835051, 0.050672253517574435, 0.049734757561855886, 0.049244000490559756, 0.047971379454418893, 0.047809143625639865, 0.046528216428023475, 0.045388962498900849, 0.043749105609058883, 0.043227958166401549, 0.041893509965017776, 0.040993755608977223, 0.039318377954821841, 0.03837264402364942, 0.036951191967283421, 0.035985917621150137, 0.03552805743360072],
            'xfn' :[0.17902483179631129, 0.9206608334290608, 1.2500664492588174, 1.8751470518217668, 2.7854136388070034, 3.2256177764581295, 3.3354162144239221, 3.9235915084469686, 5.7261412326830179, 6.3710292845587162, 5.5921671119002641, 5.2767731766654133, 5.4692758375045996, 5.5838507220596094, 6.0478345878983237, 6.4695262407871708, 5.8219168022096026, 5.9009293030525738, 5.5862731668002077, 5.649108434047112, 5.5388134552618462, 5.3756376332605447, 6.8300391877792421],
            'xfnerr' :[0.084056666627501164, 0.10853338114349957, 0.10929166336179809, 1.1433105024230374, 0.16726746495361414, 0.16682520352494024, 0.1552761303545834, 0.16621510941307546, 0.20654887364399854, 0.23679167881674365, 0.20396251113516306, 0.21989652429412895, 0.21748442476726781, 0.24924261694803887, 0.28439147206911919, 0.27170180551444273, 0.2826572889153342, 0.31391736963271488, 0.31954328932886905, 0.35946012323588056, 0.37204390676614285, 0.43007665580412052, 0.54359208474922838],


        },
    },
    'prot' : {
        'erg' : (arange(1.5,5.5,0.15) + (0.5*0.15)),
        'flux' : [6.06103750619e+12, 5.45169294196e+12, 5.43146700966e+12, 4.90150611573e+12, 4.7330994833e+12, 4.12784403345e+12, 3.90231384134e+12, 3.13129203659e+12, 3.3540517208e+12, 3.2150774519e+12, 2.40267766496e+12, 2.45145358012e+12, 2.47746769921e+12, 2.67221430295e+12, 2.43536944227e+12, 2.17467560111e+12, 2.36324372718e+12, 2.24444885454e+12, 2.17259284524e+12, 1.75384131368e+12, 2.15576782644e+12, 1.90021859844e+12, 2.12955205584e+12, 1.91462446818e+12, 1.99028606219e+12, 1.8150678559e+12, 685948245077.0],
        'basic' : {
            'measyield' :[14.3683, 59.263800000000003, 27.502800000000001, 163.11600000000001, 222.24600000000001, 292.601, 456.584, 507.35300000000001, 524.94799999999998, 438.714, 411.34199999999998, 322.47500000000002, 400.19900000000001, 397.06700000000001, 382.58600000000001, 304.02499999999998, 321.08499999999998, 230.327, 93.605999999999995],
            'measyielderr' :[4.5926299999999998, 8.2371200000000009, 6.8705299999999996, 13.3659, 16.6966, 19.131799999999998, 24.666799999999999, 26.316199999999998, 29.2818, 28.108699999999999, 28.880500000000001, 25.856000000000002, 32.065600000000003, 30.541599999999999, 31.683299999999999, 31.804400000000001, 31.8353, 30.645900000000001, 29.282699999999998],
            'fluxcorrmeasyield' :[2.531840322048621, 10.894285081244979, 6.7652224237054073, 39.32543807250795, 53.018401858654094, 64.715036747368671, 110.80427497142026, 137.88481193131875, 131.28298776406294, 115.52406454972383, 111.89879006396781, 108.66919141087241, 109.71719432315199, 123.49828038920326, 106.17969987515147, 93.848291923982742, 95.346596681715965, 74.998515223607228, 80.651605692118807],
            'fluxcorrmeasyielderr' :[0.8092680288041818, 1.5142048523575449, 1.6900338736018043, 3.2223685766528156, 3.983095527050466, 4.2314111711767746, 5.9861644079890883, 7.1520308110074486, 7.3230152155473256, 7.4017042387182581, 7.8564625216809798, 8.7130804348991919, 8.7909956457051752, 9.4992408850462038, 8.7931165415607442, 9.8175762379355085, 9.4535325830200794, 9.9788431131691429, 25.230185821616114],
            'accept' :[     0.016721009949000918, 0.27117884356790678, 0.58417563308336051, 0.88596656767413917, 0.35691058200218906, 1.2871108014124049, 1.6916051245168724, 1.8565097616481014, 2.0943863735484274, 2.1949803501250447, 2.2906180103990739, 2.3674654472670311, 2.2864670676816963, 2.272527986437904, 2.2010170484421372, 2.1602952049730262, 2.1224747265151644, 1.9808464949867866, 1.8613048408703223, 1.7415574246672223, 1.6636642668390693],
            'accepterr' :[     0.011823045217763018, 0.024619448983269399, 0.028089235497647136, 0.029532800968063381, 0.016794940981298072, 0.029177000248878378, 0.031183247925785456, 0.030803449271233994, 0.031348800113068398, 0.030963526513707623, 0.03047559311063907, 0.030237766759604334, 0.029082026191114774, 0.028485455841304276, 0.027561539357484881, 0.026898144462342548, 0.026262277522025486, 0.025153066038290258, 0.024224180768821185, 0.023244022867180244, 0.022659195096271449],
            'xfn' :[0.43340395912873225, 1.2296496819112392, 1.8954950525013887, 3.0553265522559805, 3.13420674188347, 3.4858441406695544, 5.2905364726800332, 6.2818244328913302, 5.7313348261498493, 4.8796515566080663, 4.8939602780907157, 4.7818637244246647, 4.9848407308252769, 5.7167316811567543, 5.0026367121687763, 4.7377872117550801, 5.122567490725114, 4.3064049546306506, 4.8478294148467418],
            'xfnerr' :[0.14009033334987592, 0.17575640372154583, 0.48184495855177228, 0.25976034919151153, 0.24244729041018881, 0.23514684864323557, 0.29658666143604284, 0.33767069408941885, 0.32866401937808837, 0.3187940311586282, 0.34919985548082311, 0.38806609461009295, 0.40425437480174298, 0.44544345813219649, 0.41888483212679484, 0.4992632440795341, 0.51225499141853892, 0.57585938605584464, 1.517979796425885],



        },
        'tofe' : {
            'measyield' :[22.6387, 15.523099999999999, 94.450800000000001, 152.649, 179.268, 312.13, 323.88400000000001, 378.88299999999998, 306.29500000000002, 260.416, 220.46899999999999, 318.85000000000002, 278.70400000000001, 237.797, 187.352, 186.33940000000001, 142.57599999999999, 70.322999999999993],
            'measyielderr' :[6.1388699999999998, 4.9665100000000004, 10.3072, 12.8078, 13.828200000000001, 18.193999999999999, 18.407299999999999, 20.737100000000002, 19.002300000000002, 18.944199999999999, 17.5975, 21.1204, 20.090399999999999, 19.917300000000001, 19.805, 20.646509999999999, 19.3491, 18.742699999999999],
            'fluxcorrmeasyield' :[4.1616037390241711, 3.8184193684069041, 22.771028509151979, 36.415530652167817, 39.648993706881683, 75.748029599875181, 88.022904028483609, 94.75394182473589, 80.654921774225713, 70.841867140477362, 74.294714198507265, 87.4148296470931, 86.684274285177324, 65.996178875367605, 57.832958436122077, 55.333720409589191, 46.425248913592519, 60.590804724984196],
            'fluxcorrmeasyielderr' :[1.1284899020454948, 1.2216772408491299, 2.4849503133223969, 3.0553939658969655, 3.0584053751631228, 4.4153386429481465, 5.0026058756803078, 5.1860916619444763, 5.0037676753426528, 5.1534563910857809, 5.9300910022122615, 5.7902969050527187, 6.2486428045062619, 5.5276798847687409, 6.1135282348422484, 6.1310072469760302, 6.3004066867314892, 16.148845693878453],
            'accept' :[     0.008360504974500459, 0.1815329448677723, 0.40756439517443754, 0.606867234135537, 0.22842277248140097, 0.90318863107960512, 1.208623502376901, 1.3268967384794847, 1.5068079538755732, 1.5478742408002857, 1.6407796400575974, 1.6775974873616504, 1.5978770683252386, 1.5980767544500629, 1.5478051586447354, 1.5064901278856422, 1.4654471207317274, 1.3741124641156901, 1.2721379305913836, 1.1868227627491095, 1.147711794723727],
            'accepterr' :[     0.008360504974500459, 0.020152236818718326, 0.023482900420509711, 0.024476731909774629, 0.013444612693042032, 0.024488648146773026, 0.026422967149847931, 0.02611186784405754, 0.026669862851938703, 0.026087647186840146, 0.025878575447282063, 0.025543519185308349, 0.024397130208248699, 0.023969602484861737, 0.023189716732612234, 0.022536950775327459, 0.021895203378260536, 0.021014383241665446, 0.020086634299889744, 0.019242337246946441, 0.018869674533499511],
            'xfn' :[0.68575192479327751, 1.6716456625259695, 2.5211819243044684, 3.0129755528129616, 2.9880994170138804, 5.0270526781497313, 5.686696096381433, 5.7749340320562279, 4.8077636251751494, 4.4334992062141483, 4.6490078772263894, 5.6476636712875328, 5.7540552493920831, 4.5034841545435196, 4.208750007470492, 4.3496635922070173, 3.9117255221879033, 5.27927002262527],
            'xfnerr' :[0.1879990197728888, 0.54380654886782875, 0.28349569911177924, 0.26124012983421141, 0.23787560279746209, 0.30623695686633451, 0.33710370502268622, 0.32893678965660844, 0.30712174460242514, 0.32954632518419136, 0.37757158216889081, 0.38354724493623887, 0.42361952960252869, 0.3831553083774436, 0.44953911644396605, 0.48681418280949862, 0.53463840010795516, 1.4097217199335574],



        },
    },
}

xi1530_xfn = {
    'noprot' : {
        'erg' : xi1320_xfn['prot']['erg'],
        'flux' : xi1320_xfn['prot']['flux'],
        'basic' : {
            'measyield' :[12.2143, 66.612399999999994, 106.604, 138.27099999999999, 216.89400000000001, 294.48399999999998, 238.18199999999999, 307.24200000000002, 249.87899999999999, 379.27300000000002, 385.18900000000002, 265.51400000000001, 273.08774498999998, 277.30700000000002, 205.16399999999999, 110.979],
            'measyielderr' :[4.6239999999999997, 13.778499999999999, 18.604099999999999, 26.404800000000002, 37.5747, 46.664499999999997, 44.445799999999998, 51.9009, 49.097299999999997, 62.232999999999997, 75.598299999999995, 65.168700000000001, 74.42107, 49.498699999999999, 73.380200000000002, 60.555500000000002],
            'accept' :[0.37910699241786017, 0.13965551639289753, 1.5611853790782462, 2.7979150440357077, 3.6957709862774935, 4.1475086797410157, 4.8219900598437979, 5.6469619887393501, 5.6999851175323304, 5.9965655574475454, 6.2122260976064325, 6.0995034198444671, 6.1539097371466358, 5.8501359311282277, 5.7891662617980533, 5.6188831318364993, 5.3214840467520563, 5.1031983456140706],
            'accepterr' :[0.12615580626643741, 0.030455057158372534, 0.069203102773413641, 0.07369831910819874, 0.072508227041052864, 0.068286589833801481, 0.068228721696981964, 0.068304374950998004, 0.064886614598140865, 0.063774839170218131, 0.062274633472970652, 0.059812734277319132, 0.058393448949719193, 0.055853179022502891, 0.054564765740224043, 0.052683235678895296, 0.050654989163847523, 0.049302950971519821],
            'fluxcorrmeasyield' :[2.9447307330306889, 15.890873140436316, 23.577779219539543, 33.555748568879437, 58.945918126100466, 73.646798099454244, 62.719112548453701, 83.580106229934231, 84.205438810938475, 103.98019346006568, 119.80390998203531, 73.688521881749367, 84.298391292438694, 82.346664235378825, 66.805000617974244, 95.620307972839925],
            'fluxcorrmeasyielderr' :[1.1147945366933762, 3.2869615201599371, 4.1146989079043532, 6.4079440360708171, 10.211786355605906, 11.670213016367555, 11.703659942842297, 14.118781727202638, 16.545046566267228, 17.061587246126845, 23.513059635646133, 18.086372756069963, 22.97274994706078, 14.698701543732202, 23.893881511118291, 52.175056176838034],
            'xfn' :[0.1886214649774208, 0.56795409761675042, 0.63796645698785259, 0.80905794682929433, 1.2224396441001775, 1.3041844136070664, 1.1003381808057493, 1.3937995912698786, 1.3554792998178666, 1.7047321118268524, 1.9467934223810113, 1.2596035844168523, 1.4561404437235235, 1.4655343829595593, 1.2553828975349153, 1.873732931721545],
            'xfnerr' :[0.071894764244246331, 0.11842766863239526, 0.11203667680151284, 0.15507421746440961, 0.21248054494363688, 0.20726476765667343, 0.2057096136564755, 0.23591396601740117, 0.26667680135467065, 0.28022000070602648, 0.38252956849032299, 0.30939538536426653, 0.39706038565104129, 0.26195536304363298, 0.44916684786620847, 1.0225593912059614],
        },
        'tofe' : {
            'measyield' :[1.3047599999999999, 19.2212, 50.400300000000001, 70.811800000000005, 116.977, 175.87200000000001, 194.947, 217.755, 154.393, 273.99200000000002, 204.999, 225.3339, 223.28999999999999, 237.91800000000001, 230.63499999999999, 64.358999999999995],
            'measyielderr' :[2.0329100000000002, 5.6189299999999998, 10.149100000000001, 14.2987, 18.132400000000001, 21.404599999999999, 23.7697, 24.549099999999999, 26.441800000000001, 32.024700000000003, 37.0, 38.575400000000002, 41.185000000000002, 37.792099999999998, 48.9283, 30.859999999999999],
            'accept' :[0.25273799494524007, 0.10640420296601716, 1.043906391200025, 1.9471571505601821, 2.6603051743748063, 2.966360138875856, 3.4455827162998274, 3.9718746442737931, 3.9775353066963275, 4.2504834194349046, 4.4323597539870603, 4.3193104094443919, 4.3124011052594291, 4.0954916175804259, 4.0701578168756516, 3.9158423614382163, 3.6678465025082123, 3.4442949786174633],
            'accepterr' :[0.1030710951400293, 0.026587778750087155, 0.05673710746276487, 0.061749454804863546, 0.061847592739834402, 0.058104955142749388, 0.058090241629259964, 0.057790990383716219, 0.054696031950734816, 0.054189316946272457, 0.053099125910847492, 0.050807968264413486, 0.049359173266040071, 0.04716584312782255, 0.046167499128621038, 0.044375512143924815, 0.042420065450495058, 0.040856865154684473],
            'fluxcorrmeasyield' :[0.31456300166437057, 4.5853572429000389, 11.147115924342042, 17.184680493449658, 31.791182165651673, 43.9834071642168, 51.334285689025222, 59.236647437848099, 52.028102859132723, 75.116713202654338, 63.760080745834522, 62.537274949154934, 68.926519541834068, 70.650050887834993, 75.098805431393856, 55.452179248542556],
            'fluxcorrmeasyielderr' :[0.49011179965167212, 1.3404366726764361, 2.2446928734102736, 3.4700232301916998, 4.9278954965545569, 5.3530251375272622, 6.2591400254552401, 6.6781767657067652, 8.910486163107235, 8.7797826407378476, 11.507973149117202, 10.705891994385361, 12.713237078823219, 11.222411873662981, 15.931913550800477, 26.589198893861358],
            'xfn' :[0.030133257571377057, 0.23548983920382935, 0.4190164358478799, 0.5793187505533981, 0.92266489541112684, 1.107371483327833, 1.2906054058804215, 1.3936449479368518, 1.1738240067794956, 1.7390904121733832, 1.4785285317748471, 1.5269784628713585, 1.6934606136413566, 1.8042108023441101, 2.0474904110637793, 1.6099718401819636],
            'xfnerr' :[0.046978341050440346, 0.069244591286888993, 0.084937735861086411, 0.1175282691408544, 0.14386412443080868, 0.13573297179814134, 0.15835989510977946, 0.1581171365048398, 0.20152378636881443, 0.20429495272004744, 0.26739372818808049, 0.26199760357618679, 0.31294252194995403, 0.28731837821071288, 0.43501195847785795, 0.77221417438857864],
        },
    },
    'prot' : {
        'erg' : (arange(1.5,5.5,0.25) + (0.5*0.25)),
        'flux' : [9.57376241036e+12, 8.87342877273e+12, 8.13161187374e+12, 6.64302902954e+12, 5.63748547575e+12, 5.45006457879e+12, 3.99178259543e+12, 4.22296843238e+12, 4.22443166169e+12, 3.84229788321e+12, 3.68862255648e+12, 3.17788190207e+12, 3.55284209824e+12, 3.2231834846e+12, 3.31442342825e+12, 2.50101610098e+12],
        'basic' : {
            'measyield' :[7.59145, 35.1145, 110.523, 132.55500000000001, 143.316, 149.71700000000001, 203.298, 154.87799999999999, 129.56800000000001, 56.045400000000001],
            'measyielderr' :[3.2669600000000001, 8.73935, 19.742100000000001, 24.833200000000001, 27.836400000000001, 31.766400000000001, 39.7194, 41.166699999999999, 52.014299999999999, 36.691299999999998],
            'accept' :[0.1386722135552089, 0.19436123750943224, 0.74694844233922386, 1.1188304492370642, 1.4691640621560946, 1.6745439185332329, 1.8016720668826753, 1.8000584856547688, 1.7421872632440241, 1.707243536594558, 1.6543832612362304],
            'accepterr' :[0.04899827223295676, 0.021061179877223158, 0.02818697680145069, 0.028033823715389272, 0.028222919965900903, 0.027420480683682545, 0.026602929863181055, 0.025261950360394667, 0.024008548228726848, 0.022957108792463224, 0.022690628692909668],
            'fluxcorrmeasyield' :[1.1239798769841858, 4.9143867808939907, 15.462690247594541, 20.389461823478626, 22.963132985396697, 27.844155006824767, 33.818775615379167, 28.399152705964116, 23.104173925938859, 13.24415228520812],
            'fluxcorrmeasyielderr' :[0.48370170374727561, 1.223100033137476, 2.7620131297289814, 3.8198150454891131, 4.4601506812546869, 5.9078699520348268, 6.6073521440323635, 7.5485181865766151, 9.275032676555643, 8.6705628783496351],
            'xfn' :[0.57829425835469861, 0.65792851317870993, 1.3820405279583354, 1.3878274284463334, 1.3713067021562844, 1.5454618805852847, 1.8787598227997369, 1.630086116752095, 1.3533027614809308, 0.80054921949049962],
            'xfnerr' :[0.25663556759917977, 0.16561777680119658, 0.2492830406184213, 0.2613625275507222, 0.26729504979524538, 0.32870346735146022, 0.36800893539771712, 0.43386016826081014, 0.5435800059599849, 0.52421138844521031],

        },
        'tofe' : {
            'measyield' :[4.0, 13.1388, 56.782299999999999, 120.839, 141.20599999999999, 140.46700000000001, 201.57900000000001, 126.51000000000001, 133.946, 70.0],
            'measyielderr' :[4.8518100000000004, 4.8518100000000004, 12.5709, 17.0549, 19.515999999999998, 22.552600000000002, 25.190000000000001, 26.101400000000002, 26.7761, 30.899999999999999],
            'accept' :[0.086670133472005542, 0.11890334529988797, 0.53690268237008776, 0.79561276390191227, 1.0498745432935688, 1.1809028015617509, 1.2732509300372015, 1.2736875927376701, 1.2300367361094742, 1.1956357880455264, 1.1265501931907003],
            'accepterr' :[0.038746619992994245, 0.016479309792888981, 0.023922690822189004, 0.023678801263687418, 0.023908789567329697, 0.023084545332160127, 0.022424045691084048, 0.021306684341059826, 0.02022583329591942, 0.019261770919565102, 0.018774400507577161],
            'fluxcorrmeasyield' :[0.59223462025525331, 1.8388171563544964, 7.9441122340688146, 18.58731980904027, 22.625053422757588, 26.123853145225024, 33.532818669010602, 23.197463867247258, 23.884845646176576, 16.541779699396709],
            'fluxcorrmeasyielderr' :[0.71835246322516022, 0.67902635456604177, 1.7587283446294999, 2.6233656403247374, 3.1269956134904819, 4.1943005150177752, 4.1903754968145348, 4.7860744872703149, 4.7746331768517809, 7.3020141815908328],
            'xfn' :[0.49808070476198052, 0.34248611838504417, 0.99848979233422763, 1.7704324700292149, 1.9159115714549766, 2.0517442814246944, 2.6327349705067786, 1.8859163459312049, 1.9976690130044101, 1.468357095794004],
            'xfnerr' :[0.60807925552224273, 0.12738835201877577, 0.22304181671835996, 0.25310602989643904, 0.26743255532741489, 0.33139257079989143, 0.33193027506387462, 0.3903339183733095, 0.40063312336705115, 0.64863653656476128],
        },
    },
}

xiulimit = {
    'erg' : xi1530_xfn['prot']['erg'],
    'flux' : xi1530_xfn['prot']['flux'],
    'xi1620' : {
        'measyield' : [17.426033333333333, 15.017284666666667, 17.871028999999997, 36.31812, 24.037462333333337, 31.096266666666665, 26.978263333333331, 32.13814],
        'measyieldfluxcorr' : [2.437984452807024, 2.3099419290355772, 2.8634263830478166, 6.7543923725192379, 3.998649986788501, 5.7019565441963902, 4.8106823310779845, 7.5946004546909904],
        'accept' : [0.00097885669537979645, 0.0013578407021029972, 0.0038945179708901284, 0.005967354504359668, 0.0085052052641917102, 0.010340863654538185, 0.01215050137988736, 0.012757510729613734, 0.012758557744963348, 0.012644778628806277, 0.013002126314579622],
        'ulimit' : [408.55364819131592, 271.59155567482969, 276.90398778163711, 555.8941282620433, 313.43496952791281, 446.91231236127231, 380.44812584687645, 584.10449729095205],

    },
    'xi1690' : {
        'measyield' : [33.185466666666663, 34.845500000000001, 27.048856666666666, 42.863076666666664, 32.514466666666664, 63.740633333333335, 43.060139999999997],
        'measyieldfluxcorr' : [5.1045513612788831, 5.58319971561194, 5.0305079435471729, 7.1303051283081702, 5.9620043131990776, 11.366036974274738, 10.175590710074003],
        'accept' : [ 0.00096082779009608278, 0.0030793408086986071, 0.0041514671383126372, 0.0065258689898018392, 0.0090340357296113099, 0.011194492132882605, 0.012087070863199998, 0.013118709239642628, 0.01369686944664871, 0.013458151870169037],
        'ulimit' : [782.20254946213447, 618.01833452037465, 449.37348508831428, 589.91175025017219, 454.46577131101134, 829.82735715975821, 756.09123810149094],
    },
    'xi1820' : {
        'measyield' : [12.920293333333333, 37.91663333333333, 39.117510000000003, 36.572603333333333, 49.69580666666667, 43.875849999999993],
        'measyieldfluxcorr' : [2.070183468863684, 7.051681611776031, 6.5072272886223708, 6.7061231867533531, 8.8616059568450449, 10.36835206891107],
        'accept' : [ 0.00098851440406703072, 0.0033674470359145547, 0.0049180648441472094, 0.0068996276498692385, 0.0082974859928337686, 0.0098738363913915411, 0.011258533362695441, 0.011970734744707348, 0.013190526083069795],
        'ulimit' : [300.04278113514118, 849.85760962613347, 659.03738229809721, 595.64802720874286, 740.27251842357032, 786.04537860085657],
    },
}

exulimit = {
    'erg' : xi1530_xfn['prot']['erg'],
    'flux' : xi1530_xfn['prot']['flux'],
    'xi--' : {
    },
    'xi+' : {
    },
    'sigma--' : {
    },
    'sigma++' : {
    },
    'omega-' : {
    },
}

def sigfigs(x, n):
    ret = '{0:g}'.format(float(str('{0:.'+str(n-1)+'e}').format(float(x))))
    ret_len = len(ret.replace('.',''))
    ret_len -= (ret_len - len(ret.lstrip('0.')))
    if float(ret) > 1. and ret.count('.') == 1:
        ret_len -= 1
    if ret_len < n:
        if ret.count('.') == 0:
            ret += '.'
        ret += '0'*(n-ret_len)
    return ret

print r'\begin{tabular}{ccrrcccc}'
print r'\multicolumn{8}{c}{$\Xi^-$(1320)} \\'
print r'\hline \hline'
print r'$E_\mathrm{beam}$',
print r' & $F$',
print r' & $N$',
print r' & $\delta N$',
print r' & $A$',
print r' & $\delta A$',
print r' & $\sigma$',
print r' & $\delta \sigma$',
print r' \\'
print r' (GeV)',
print r' & ($10^{12}$)',
print r' & ',
print r' & ',
print r' & (\%)',
print r' & ',
print r' & (nb)',
print r' & ',
print r' \\'
print r'\hline'
print '\n\n'


part = xi1530_xfn['prot']
cut = part['tofe']
l = len(cut['measyield'])
for x in zip(
    part['erg'][-l:],
    part['flux'][-l:],
    cut['measyield'],
    cut['measyielderr'],
    cut['accept'][-l:],
    cut['accepterr'][-l:],
    cut['xfn'],
    cut['xfnerr'],
    ):
    print '{0:0.3f}'.format(x[0]),
    print r'&','{0:.3f}'.format(10**-12 * x[1]),
    print r'&','{0:.0f}'.format(x[2]),
    print r'&','{0:.0f}'.format(x[3]),
    print r'&','{0:.2f}'.format(x[4]),
    print r'&','{0:.3f}'.format(x[5]),
    print r'&','{0:.2f}'.format(x[6]),
    print r'&','{0:.2f}'.format(x[7]),
    print r'\\'


print '\n\n'
print r'\hline \hline'
print r'\end{tabular}'



for a in ['xi1620', 'xi1690', 'xi1820']:
    x = xiulimit[a]

    mean = sum(x['ulimit']) / len(x['ulimit'])
    sigma = sqrt(sum( (array(x['ulimit']) - mean)**2 )) / len(x['ulimit'])

    print r'''

\begin{tabular}{ccccc}
\hline \hline
\multicolumn{5}{c}{$\Xi^-$(1620) Upper Limit} \\
\multicolumn{5}{c}{$\Delta E_\mathrm{beam} = 250$~MeV} \\
\hline
$E_\mathrm{beam}$ (GeV) & $N$ & $A$ (\%) & $\sigma$ (pb) \\
\hline
    '''
    l = len(x['ulimit'])
    for x in zip(
        xiulimit['erg'][-l:],
        x['measyield'][-l:],
        x['measyieldfluxcorr'][-l:],
        x['accept'][-l:],
        x['ulimit'],
        ):
        print sigfigs(x[0], 4),
        print r'&',sigfigs(x[1], 3),
        print r'&',sigfigs(100. * x[3], 3),
        print r'&',sigfigs(x[4], 3),
        print r'\\'
    print r'''
\hline
\multicolumn{5}{c}{$\sigma = ''' + sigfigs(mean, 3) + r''' \pm ''' + sigfigs(sigma, 2) + r'''$} \\
\hline \hline
\end{tabular}


'''



exit(0)


def hist2line(erg, data):
    ebinwid = (erg[1] - erg[0])
    x = [erg[0]-0.5*ebinwid]
    y = [0]
    b = 0
    for a in erg:
        x += [a - 0.5*ebinwid, a + 0.5*ebinwid]
        y += [data[b], data[b]]
        b += 1
    x += [erg[-1]+0.5*ebinwid]
    y += [0]
    return [x, y]

part = xi1320_xfn['noprot']
fig = pyplot.figure()
ax = fig.add_subplot(111)
h = part['basic']['accept']
x, y = hist2line(part['erg'][-len(h):], h)
ax.fill(x, y)

pyplot.show()
